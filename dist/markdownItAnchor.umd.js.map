{"version":3,"file":"markdownItAnchor.umd.js","sources":["../permalink.js","../index.js"],"sourcesContent":["let emittedWarning = false\n\nconst position = {\n  false: 'push',\n  true: 'unshift',\n  after: 'push',\n  before: 'unshift'\n}\n\nconst permalinkSymbolMeta = {\n  isPermalinkSymbol: true\n}\n\nexport function legacy (slug, opts, state, idx) {\n  if (!emittedWarning) {\n    const warningText = 'Using deprecated markdown-it-anchor permalink option, see https://github.com/valeriangalliat/markdown-it-anchor#permalinks'\n\n    if (typeof process === 'object' && process && process.emitWarning) {\n      process.emitWarning(warningText)\n    } else {\n      console.warn(warningText)\n    }\n\n    emittedWarning = true\n  }\n\n  const linkTokens = [\n    Object.assign(new state.Token('link_open', 'a', 1), {\n      attrs: [\n        ...(opts.permalinkClass ? [['class', opts.permalinkClass]] : []),\n        ['href', opts.permalinkHref(slug, state)],\n        ...Object.entries(opts.permalinkAttrs(slug, state))\n      ]\n    }),\n    Object.assign(new state.Token('html_block', '', 0), { content: opts.permalinkSymbol, meta: permalinkSymbolMeta }),\n    new state.Token('link_close', 'a', -1)\n  ]\n\n  if (opts.permalinkSpace) {\n    state.tokens[idx + 1].children[position[opts.permalinkBefore]](Object.assign(new state.Token('text', '', 0), { content: ' ' }))\n  }\n\n  state.tokens[idx + 1].children[position[opts.permalinkBefore]](...linkTokens)\n}\n\nexport function renderHref (slug) {\n  return `#${slug}`\n}\n\nexport function renderAttrs (slug) {\n  return {}\n}\n\nconst commonDefaults = {\n  class: 'header-anchor',\n  symbol: '#',\n  renderHref,\n  renderAttrs\n}\n\nexport function makePermalink (renderPermalinkImpl) {\n  function renderPermalink (opts) {\n    opts = Object.assign({}, renderPermalink.defaults, opts)\n\n    return (slug, anchorOpts, state, idx) => {\n      return renderPermalinkImpl(slug, opts, anchorOpts, state, idx)\n    }\n  }\n\n  renderPermalink.defaults = Object.assign({}, commonDefaults)\n  renderPermalink.renderPermalinkImpl = renderPermalinkImpl\n\n  return renderPermalink\n}\n\nfunction mergeDuplicateClassAttrs(attrs) {\n  const classValues = [];\n  const mergedAttrs = attrs.filter(([key, value]) => {\n      if (key !== 'class') {\n        return true;\n      }\n      classValues.push(value);\n  });\n\n  if (classValues.length > 0) {\n      mergedAttrs.unshift(['class', classValues.join(' ')]);\n  }\n\n  return mergedAttrs;\n}\n\nexport const linkInsideHeader = makePermalink((slug, opts, anchorOpts, state, idx) => {\n  const linkTokens = [\n    Object.assign(new state.Token('link_open', 'a', 1), {\n      attrs: mergeDuplicateClassAttrs([\n        ...(opts.class ? [['class', opts.class]] : []),\n        ['href', opts.renderHref(slug, state)],\n        ...(opts.ariaHidden ? [['aria-hidden', 'true']] : []),\n        ...Object.entries(opts.renderAttrs(slug, state))\n      ])\n    }),\n    Object.assign(new state.Token('html_inline', '', 0), { content: opts.symbol, meta: permalinkSymbolMeta }),\n    new state.Token('link_close', 'a', -1)\n  ]\n\n  if (opts.space) {\n    const space = typeof opts.space === 'string' ? opts.space : ' '\n    const type = typeof opts.space === 'string' ? 'html_inline' : 'text'\n    state.tokens[idx + 1].children[position[opts.placement]](Object.assign(new state.Token(type, '', 0), { content: space }))\n  }\n\n  state.tokens[idx + 1].children[position[opts.placement]](...linkTokens)\n})\n\nObject.assign(linkInsideHeader.defaults, {\n  space: true,\n  placement: 'after',\n  ariaHidden: false\n})\n\nexport const ariaHidden = makePermalink(linkInsideHeader.renderPermalinkImpl)\n\nariaHidden.defaults = Object.assign({}, linkInsideHeader.defaults, {\n  ariaHidden: true\n})\n\nexport const headerLink = makePermalink((slug, opts, anchorOpts, state, idx) => {\n  const linkTokens = [\n    Object.assign(new state.Token('link_open', 'a', 1), {\n      attrs: mergeDuplicateClassAttrs([\n        ...(opts.class ? [['class', opts.class]] : []),\n        ['href', opts.renderHref(slug, state)],\n        ...Object.entries(opts.renderAttrs(slug, state))\n      ])\n    }),\n    ...(opts.safariReaderFix ? [new state.Token('span_open', 'span', 1)] : []),\n    ...state.tokens[idx + 1].children,\n    ...(opts.safariReaderFix ? [new state.Token('span_close', 'span', -1)] : []),\n    new state.Token('link_close', 'a', -1)\n  ]\n\n  state.tokens[idx + 1] = Object.assign(new state.Token('inline', '', 0), {\n    children: linkTokens\n  })\n})\n\nObject.assign(headerLink.defaults, {\n  safariReaderFix: false\n})\n\nexport const linkAfterHeader = makePermalink((slug, opts, anchorOpts, state, idx) => {\n  if (!['visually-hidden', 'aria-label', 'aria-describedby', 'aria-labelledby'].includes(opts.style)) {\n    throw new Error(`\\`permalink.linkAfterHeader\\` called with unknown style option \\`${opts.style}\\``)\n  }\n\n  if (!['aria-describedby', 'aria-labelledby'].includes(opts.style) && !opts.assistiveText) {\n    throw new Error(`\\`permalink.linkAfterHeader\\` called without the \\`assistiveText\\` option in \\`${opts.style}\\` style`)\n  }\n\n  if (opts.style === 'visually-hidden' && !opts.visuallyHiddenClass) {\n    throw new Error('`permalink.linkAfterHeader` called without the `visuallyHiddenClass` option in `visually-hidden` style')\n  }\n\n  const title = state.tokens[idx + 1]\n    .children\n    .filter(token => token.type === 'text' || token.type === 'code_inline')\n    .reduce((acc, t) => acc + t.content, '')\n\n  const subLinkTokens = []\n  const linkAttrs = []\n\n  if (opts.class) {\n    linkAttrs.push(['class', opts.class])\n  }\n\n  linkAttrs.push(['href', opts.renderHref(slug, state)])\n  linkAttrs.push(...Object.entries(opts.renderAttrs(slug, state)))\n\n  if (opts.style === 'visually-hidden') {\n    subLinkTokens.push(\n      Object.assign(new state.Token('span_open', 'span', 1), {\n        attrs: [['class', opts.visuallyHiddenClass]],\n      }),\n      Object.assign(new state.Token('text', '', 0), {\n        content: opts.assistiveText(title)\n      }),\n      new state.Token('span_close', 'span', -1)\n    )\n\n    if (opts.space) {\n      const space = typeof opts.space === 'string' ? opts.space : ' '\n      const type = typeof opts.space === 'string' ? 'html_inline' : 'text'\n      subLinkTokens[position[opts.placement]](Object.assign(new state.Token(type, '', 0), { content: space }))\n    }\n\n    subLinkTokens[position[opts.placement]](\n      Object.assign(new state.Token('span_open', 'span', 1), {\n        attrs: [['aria-hidden', 'true']],\n      }),\n      Object.assign(new state.Token('html_inline', '', 0), {\n        content: opts.symbol,\n        meta: permalinkSymbolMeta\n      }),\n      new state.Token('span_close', 'span', -1)\n    )\n  } else {\n    subLinkTokens.push(\n      Object.assign(new state.Token('html_inline', '', 0), {\n        content: opts.symbol,\n        meta: permalinkSymbolMeta\n      })\n    )\n  }\n\n  if (opts.style === 'aria-label') {\n    linkAttrs.push(['aria-label', opts.assistiveText(title)])\n  } else if (['aria-describedby', 'aria-labelledby'].includes(opts.style)) {\n    linkAttrs.push([opts.style, slug])\n  }\n\n  const linkTokens = [\n    Object.assign(new state.Token('link_open', 'a', 1), {\n      attrs:  mergeDuplicateClassAttrs(linkAttrs)\n    }),\n    ...subLinkTokens,\n    new state.Token('link_close', 'a', -1),\n  ]\n\n  state.tokens.splice(idx + 3, 0, ...linkTokens)\n\n  if (opts.wrapper) {\n    state.tokens.splice(idx, 0, Object.assign(new state.Token('html_block', '', 0), {\n      content: opts.wrapper[0] + '\\n'\n    }))\n\n    state.tokens.splice(idx + 3 + linkTokens.length + 1, 0, Object.assign(new state.Token('html_block', '', 0), {\n      content: opts.wrapper[1] + '\\n'\n    }))\n  }\n})\n\nObject.assign(linkAfterHeader.defaults, {\n  style: 'visually-hidden',\n  space: true,\n  placement: 'after',\n  wrapper: null\n})\n","import * as permalink from './permalink'\n\nconst slugify = (s) => encodeURIComponent(String(s).trim().toLowerCase().replace(/\\s+/g, '-'))\n\nfunction getTokensText (tokens) {\n  return tokens\n    .filter(t => ['text', 'code_inline'].includes(t.type))\n    .map(t => t.content)\n    .join('')\n}\n\nfunction uniqueSlug (slug, slugs, failOnNonUnique, startIndex) {\n  let uniq = slug\n  let i = startIndex\n\n  if (failOnNonUnique && Object.prototype.hasOwnProperty.call(slugs, uniq)) {\n    throw new Error(`User defined \\`id\\` attribute \\`${slug}\\` is not unique. Please fix it in your Markdown to continue.`)\n  } else {\n    while (Object.prototype.hasOwnProperty.call(slugs, uniq)) {\n      uniq = `${slug}-${i}`\n      i += 1\n    }\n  }\n\n  slugs[uniq] = true\n\n  return uniq\n}\n\nconst isLevelSelectedNumber = selection => level => level >= selection\nconst isLevelSelectedArray = selection => level => selection.includes(level)\n\nfunction anchor (md, opts) {\n  opts = Object.assign({}, anchor.defaults, opts)\n\n  md.core.ruler.push('anchor', state => {\n    const slugs = {}\n    const tokens = state.tokens\n\n    const isLevelSelected = Array.isArray(opts.level)\n      ? isLevelSelectedArray(opts.level)\n      : isLevelSelectedNumber(opts.level)\n\n    for (let idx = 0; idx < tokens.length; idx++) {\n      const token = tokens[idx]\n\n      if (token.type !== 'heading_open') {\n        continue\n      }\n\n      if (!isLevelSelected(Number(token.tag.substr(1)))) {\n        continue\n      }\n\n      // Aggregate the next token children text.\n      const title = opts.getTokensText(tokens[idx + 1].children)\n\n      let slug = token.attrGet('id')\n\n      if (slug == null) {\n        if (opts.slugifyWithState) {\n          slug = opts.slugifyWithState(title, state)\n        } else {\n          slug = opts.slugify(title)\n        }\n\n        slug = uniqueSlug(slug, slugs, false, opts.uniqueSlugStartIndex)\n      } else {\n        slug = uniqueSlug(slug, slugs, true, opts.uniqueSlugStartIndex)\n      }\n\n      token.attrSet('id', slug)\n\n      if (opts.tabIndex !== false) {\n        token.attrSet('tabindex', `${opts.tabIndex}`)\n      }\n\n      if (typeof opts.permalink === 'function') {\n        opts.permalink(slug, opts, state, idx)\n      } else if (opts.permalink) {\n        opts.renderPermalink(slug, opts, state, idx)\n      } else if (opts.renderPermalink && opts.renderPermalink !== permalink.legacy) {\n        opts.renderPermalink(slug, opts, state, idx)\n      }\n\n      // A permalink renderer could modify the `tokens` array so\n      // make sure to get the up-to-date index on each iteration.\n      idx = tokens.indexOf(token)\n\n      if (opts.callback) {\n        opts.callback(token, { slug, title })\n      }\n    }\n  })\n}\n\nanchor.permalink = permalink\n\nanchor.defaults = {\n  level: 1,\n  slugify,\n  uniqueSlugStartIndex: 1,\n  tabIndex: '-1',\n  getTokensText,\n\n  // Legacy options.\n  permalink: false,\n  renderPermalink: permalink.legacy,\n  permalinkClass: permalink.ariaHidden.defaults.class,\n  permalinkSpace: permalink.ariaHidden.defaults.space,\n  permalinkSymbol: 'Â¶',\n  permalinkBefore: permalink.ariaHidden.defaults.placement === 'before',\n  permalinkHref: permalink.ariaHidden.defaults.renderHref,\n  permalinkAttrs: permalink.ariaHidden.defaults.renderAttrs\n}\n\n// Dirty hack to make `import anchor from 'markdown-it-anchor'` work with\n// TypeScript which doesn't support the `module` field of `package.json` and\n// will always get the CommonJS version which otherwise wouldn't have a\n// `default` key, resulting in markdown-it-anchor being undefined when being\n// imported that way.\nanchor.default = anchor\n\nexport default anchor\n"],"names":["emittedWarning","position","false","true","after","before","permalinkSymbolMeta","isPermalinkSymbol","legacy","slug","opts","state","idx","_state$tokens$childre","warningText","process","emitWarning","console","warn","linkTokens","Object","assign","Token","attrs","concat","permalinkClass","permalinkHref","entries","permalinkAttrs","content","permalinkSymbol","meta","permalinkSpace","tokens","children","permalinkBefore","apply","renderHref","renderAttrs","commonDefaults","class","symbol","makePermalink","renderPermalinkImpl","renderPermalink","defaults","anchorOpts","mergeDuplicateClassAttrs","classValues","mergedAttrs","filter","_ref","push","length","unshift","join","linkInsideHeader","_state$tokens$childre2","ariaHidden","space","placement","headerLink","safariReaderFix","linkAfterHeader","_state$tokens","includes","style","Error","assistiveText","visuallyHiddenClass","title","token","type","reduce","acc","t","subLinkTokens","linkAttrs","splice","wrapper","uniqueSlug","slugs","failOnNonUnique","startIndex","uniq","i","prototype","hasOwnProperty","call","anchor","md","core","ruler","selection","isLevelSelected","Array","isArray","level","isLevelSelectedNumber","Number","tag","substr","getTokensText","attrGet","slugifyWithState","slugify","uniqueSlugStartIndex","attrSet","tabIndex","permalink","indexOf","callback","s","encodeURIComponent","String","trim","toLowerCase","replace","map"],"mappings":"mOAAA,IAAIA,GAAiB,EAEfC,EAAW,CACfC,MAAO,OACPC,KAAM,UACNC,MAAO,OACPC,OAAQ,WAGJC,EAAsB,CAC1BC,mBAAmB,GAGL,SAAAC,EAAQC,EAAMC,EAAMC,EAAOC,GAAKC,IAAAA,EAC9C,IAAKb,EAAgB,CACnB,IAAMc,EAAc,6HAEG,iBAAZC,SAAwBA,SAAWA,QAAQC,YACpDD,QAAQC,YAAYF,GAEpBG,QAAQC,KAAKJ,GAGfd,GAAiB,CACnB,CAEA,IAAMmB,EAAa,CACjBC,OAAOC,OAAO,IAAIV,EAAMW,MAAM,YAAa,IAAK,GAAI,CAClDC,MAAKC,GAAAA,OACCd,EAAKe,eAAiB,CAAC,CAAC,QAASf,EAAKe,iBAAmB,IAC7D,CAAC,OAAQf,EAAKgB,cAAcjB,EAAME,KAC/BS,OAAOO,QAAQjB,EAAKkB,eAAenB,EAAME,OAGhDS,OAAOC,OAAO,IAAIV,EAAMW,MAAM,aAAc,GAAI,GAAI,CAAEO,QAASnB,EAAKoB,gBAAiBC,KAAMzB,IAC3F,IAAIK,EAAMW,MAAM,aAAc,KAAM,IAGlCZ,EAAKsB,gBACPrB,EAAMsB,OAAOrB,EAAM,GAAGsB,SAASjC,EAASS,EAAKyB,kBAAkBf,OAAOC,OAAO,IAAIV,EAAMW,MAAM,OAAQ,GAAI,GAAI,CAAEO,QAAS,QAG1HhB,EAAAF,EAAMsB,OAAOrB,EAAM,GAAGsB,UAASjC,EAASS,EAAKyB,kBAAiBC,MAAAvB,EAAIM,EACpE,CAEgB,SAAAkB,EAAY5B,GAC1B,MAAWA,IAAAA,CACb,CAEgB,SAAA6B,EAAa7B,GAC3B,MAAO,CACT,CAAA,CAEA,IAAM8B,EAAiB,CACrBC,MAAO,gBACPC,OAAQ,IACRJ,WAAAA,EACAC,YAAAA,GAGK,SAASI,EAAeC,GAC7B,SAASC,EAAiBlC,GAGxB,OAFAA,EAAOU,OAAOC,OAAO,GAAIuB,EAAgBC,SAAUnC,GAE3CD,SAAAA,EAAMqC,EAAYnC,EAAOC,GAC/B,OAAO+B,EAAoBlC,EAAMC,EAAMoC,EAAYnC,EAAOC,EAC5D,CACF,CAKA,OAHAgC,EAAgBC,SAAWzB,OAAOC,OAAO,CAAE,EAAEkB,GAC7CK,EAAgBD,oBAAsBA,EAE/BC,CACT,CAEA,SAASG,EAAyBxB,GAChC,IAAMyB,EAAc,GACdC,EAAc1B,EAAM2B,OAAO,SAAAC,GAC7B,GAAY,UADsBA,EAAA,GAEhC,OAAO,EAETH,EAAYI,KAJ6BD,EACzC,GAIJ,GAMA,OAJIH,EAAYK,OAAS,GACrBJ,EAAYK,QAAQ,CAAC,QAASN,EAAYO,KAAK,OAG5CN,CACT,CAEO,IAAMO,EAAmBd,EAAc,SAACjC,EAAMC,EAAMoC,EAAYnC,EAAOC,GAAQ6C,IAAAA,EAC9EtC,EAAa,CACjBC,OAAOC,OAAO,IAAIV,EAAMW,MAAM,YAAa,IAAK,GAAI,CAClDC,MAAOwB,EAAwB,GAAAvB,OACzBd,EAAU,MAAG,CAAC,CAAC,QAASA,EAAI,QAAW,IAC3C,CAAC,OAAQA,EAAK2B,WAAW5B,EAAME,KAC3BD,EAAKgD,WAAa,CAAC,CAAC,cAAe,SAAW,GAC/CtC,OAAOO,QAAQjB,EAAK4B,YAAY7B,EAAME,QAG7CS,OAAOC,OAAO,IAAIV,EAAMW,MAAM,cAAe,GAAI,GAAI,CAAEO,QAASnB,EAAK+B,OAAQV,KAAMzB,IACnF,IAAIK,EAAMW,MAAM,aAAc,KAAM,IAGtC,GAAIZ,EAAKiD,MAAO,CACd,IAAMA,EAA8B,iBAAfjD,EAAKiD,MAAqBjD,EAAKiD,MAAQ,IAE5DhD,EAAMsB,OAAOrB,EAAM,GAAGsB,SAASjC,EAASS,EAAKkD,YAAYxC,OAAOC,OAAO,IAAIV,EAAMW,MAD9C,iBAAfZ,EAAKiD,MAAqB,cAAgB,OAC+B,GAAI,GAAI,CAAE9B,QAAS8B,IAClH,EAEAF,EAAA9C,EAAMsB,OAAOrB,EAAM,GAAGsB,UAASjC,EAASS,EAAKkD,YAAWxB,MAAAqB,EAAItC,EAC9D,GAEAC,OAAOC,OAAOmC,EAAiBX,SAAU,CACvCc,OAAO,EACPC,UAAW,QACXF,YAAY,IAGP,IAAMA,EAAahB,EAAcc,EAAiBb,qBAEzDe,EAAWb,SAAWzB,OAAOC,OAAO,GAAImC,EAAiBX,SAAU,CACjEa,YAAY,IAGD,IAAAG,EAAanB,EAAc,SAACjC,EAAMC,EAAMoC,EAAYnC,EAAOC,GACtE,IAAMO,EACJC,CAAAA,OAAOC,OAAO,IAAIV,EAAMW,MAAM,YAAa,IAAK,GAAI,CAClDC,MAAOwB,EAAwB,GAAAvB,OACzBd,EAAU,MAAG,CAAC,CAAC,QAASA,EAAU,QAAK,GAAE,CAC7C,CAAC,OAAQA,EAAK2B,WAAW5B,EAAME,KAC5BS,OAAOO,QAAQjB,EAAK4B,YAAY7B,EAAME,SAE3Ca,OACEd,EAAKoD,gBAAkB,CAAC,IAAInD,EAAMW,MAAM,YAAa,OAAQ,IAAM,GACpEX,EAAMsB,OAAOrB,EAAM,GAAGsB,SACrBxB,EAAKoD,gBAAkB,CAAC,IAAInD,EAAMW,MAAM,aAAc,QAAS,IAAM,GACzE,CAAA,IAAIX,EAAMW,MAAM,aAAc,KAAM,KAGtCX,EAAMsB,OAAOrB,EAAM,GAAKQ,OAAOC,OAAO,IAAIV,EAAMW,MAAM,SAAU,GAAI,GAAI,CACtEY,SAAUf,GAEd,GAEAC,OAAOC,OAAOwC,EAAWhB,SAAU,CACjCiB,iBAAiB,IAGN,IAAAC,EAAkBrB,EAAc,SAACjC,EAAMC,EAAMoC,EAAYnC,EAAOC,GAAQoD,IAAAA,EACnF,IAAK,CAAC,kBAAmB,aAAc,mBAAoB,mBAAmBC,SAASvD,EAAKwD,OAC1F,MAAM,IAAIC,uEAA0EzD,EAAKwD,MAAK,KAGhG,IAAK,CAAC,mBAAoB,mBAAmBD,SAASvD,EAAKwD,SAAWxD,EAAK0D,cACzE,MAAU,IAAAD,MAAK,6EAAmFzD,EAAKwD,MAAK,WAG9G,GAAmB,oBAAfxD,EAAKwD,QAAgCxD,EAAK2D,oBAC5C,MAAU,IAAAF,MAAM,0GAGlB,IAAMG,EAAQ3D,EAAMsB,OAAOrB,EAAM,GAC9BsB,SACAgB,OAAO,SAAAqB,GAAS,MAAe,SAAfA,EAAMC,MAAkC,gBAAfD,EAAMC,IAAsB,GACrEC,OAAO,SAACC,EAAKC,GAAM,OAAAD,EAAMC,EAAE9C,OAAO,EAAE,IAEjC+C,EAAgB,GAChBC,EAAY,GASlB,GAPInE,EAAU,OACZmE,EAAUzB,KAAK,CAAC,QAAS1C,EAAI,QAG/BmE,EAAUzB,KAAK,CAAC,OAAQ1C,EAAK2B,WAAW5B,EAAME,KAC9CkE,EAAUzB,KAAIhB,MAAdyC,EAAkBzD,OAAOO,QAAQjB,EAAK4B,YAAY7B,EAAME,KAErC,oBAAfD,EAAKwD,MAA6B,CAWpC,GAVAU,EAAcxB,KACZhC,OAAOC,OAAO,IAAIV,EAAMW,MAAM,YAAa,OAAQ,GAAI,CACrDC,MAAO,CAAC,CAAC,QAASb,EAAK2D,wBAEzBjD,OAAOC,OAAO,IAAIV,EAAMW,MAAM,OAAQ,GAAI,GAAI,CAC5CO,QAASnB,EAAK0D,cAAcE,KAE9B,IAAI3D,EAAMW,MAAM,aAAc,QAAS,IAGrCZ,EAAKiD,MAAO,CACd,IAAMA,EAA8B,iBAAfjD,EAAKiD,MAAqBjD,EAAKiD,MAAQ,IAE5DiB,EAAc3E,EAASS,EAAKkD,YAAYxC,OAAOC,OAAO,IAAIV,EAAMW,MAD7B,iBAAfZ,EAAKiD,MAAqB,cAAgB,OACc,GAAI,GAAI,CAAE9B,QAAS8B,IACjG,CAEAiB,EAAc3E,EAASS,EAAKkD,YAC1BxC,OAAOC,OAAO,IAAIV,EAAMW,MAAM,YAAa,OAAQ,GAAI,CACrDC,MAAO,CAAC,CAAC,cAAe,WAE1BH,OAAOC,OAAO,IAAIV,EAAMW,MAAM,cAAe,GAAI,GAAI,CACnDO,QAASnB,EAAK+B,OACdV,KAAMzB,IAER,IAAIK,EAAMW,MAAM,aAAc,QAAS,GAE3C,MACEsD,EAAcxB,KACZhC,OAAOC,OAAO,IAAIV,EAAMW,MAAM,cAAe,GAAI,GAAI,CACnDO,QAASnB,EAAK+B,OACdV,KAAMzB,KAKO,eAAfI,EAAKwD,MACPW,EAAUzB,KAAK,CAAC,aAAc1C,EAAK0D,cAAcE,KACxC,CAAC,mBAAoB,mBAAmBL,SAASvD,EAAKwD,QAC/DW,EAAUzB,KAAK,CAAC1C,EAAKwD,MAAOzD,IAG9B,IAAMU,EAAU,CACdC,OAAOC,OAAO,IAAIV,EAAMW,MAAM,YAAa,IAAK,GAAI,CAClDC,MAAQwB,EAAyB8B,MACjCrD,OACCoD,EAAa,CAChB,IAAIjE,EAAMW,MAAM,aAAc,KAAM,MAGtC0C,EAAArD,EAAMsB,QAAO6C,OAAM1C,MAAA4B,EAAA,CAACpD,EAAM,EAAG,GAACY,OAAKL,IAE/BT,EAAKqE,UACPpE,EAAMsB,OAAO6C,OAAOlE,EAAK,EAAGQ,OAAOC,OAAO,IAAIV,EAAMW,MAAM,aAAc,GAAI,GAAI,CAC9EO,QAASnB,EAAKqE,QAAQ,GAAK,QAG7BpE,EAAMsB,OAAO6C,OAAOlE,EAAM,EAAIO,EAAWkC,OAAS,EAAG,EAAGjC,OAAOC,OAAO,IAAIV,EAAMW,MAAM,aAAc,GAAI,GAAI,CAC1GO,QAASnB,EAAKqE,QAAQ,GAAK,QAGjC,GCpOA,SAASC,EAAYvE,EAAMwE,EAAOC,EAAiBC,GACjD,IAAIC,EAAO3E,EACP4E,EAAIF,EAER,GAAID,GAAmB9D,OAAOkE,UAAUC,eAAeC,KAAKP,EAAOG,GACjE,UAAUjB,MAAyC1D,gCAAAA,kEAEnD,KAAOW,OAAOkE,UAAUC,eAAeC,KAAKP,EAAOG,IACjDA,EAAU3E,EAAQ4E,IAAAA,EAClBA,GAAK,EAMT,OAFAJ,EAAMG,IAAQ,EAEPA,CACT,CAKA,SAASK,EAAQC,EAAIhF,GACnBA,EAAOU,OAAOC,OAAO,CAAE,EAAEoE,EAAO5C,SAAUnC,GAE1CgF,EAAGC,KAAKC,MAAMxC,KAAK,SAAU,SAAAzC,GAQ3B,IAPA,IANyBkF,EAMnBZ,EAAQ,CAAE,EACVhD,EAAStB,EAAMsB,OAEf6D,EAAkBC,MAAMC,QAAQtF,EAAKuF,QATlBJ,EAUAnF,EAAKuF,eAVQA,GAAK,OAAIJ,EAAU5B,SAASgC,EAAM,GAD9C,SAAAJ,UAAaI,SAAAA,UAASA,GAASJ,CAAS,EAY9DK,CAAsBxF,EAAKuF,OAEtBrF,EAAM,EAAGA,EAAMqB,EAAOoB,OAAQzC,IAAO,CAC5C,IAAM2D,EAAQtC,EAAOrB,GAErB,GAAmB,iBAAf2D,EAAMC,MAILsB,EAAgBK,OAAO5B,EAAM6B,IAAIC,OAAO,KAA7C,CAKA,IAAM/B,EAAQ5D,EAAK4F,cAAcrE,EAAOrB,EAAM,GAAGsB,UAE7CzB,EAAO8D,EAAMgC,QAAQ,MASvB9F,EAPU,MAARA,EAOKuE,EALLvE,EADEC,EAAK8F,iBACA9F,EAAK8F,iBAAiBlC,EAAO3D,GAE7BD,EAAK+F,QAAQnC,GAGEW,GAAO,EAAOvE,EAAKgG,sBAEpC1B,EAAWvE,EAAMwE,GAAO,EAAMvE,EAAKgG,sBAG5CnC,EAAMoC,QAAQ,KAAMlG,IAEE,IAAlBC,EAAKkG,UACPrC,EAAMoC,QAAQ,cAAejG,EAAKkG,UAGN,mBAAnBlG,EAAKmG,UACdnG,EAAKmG,UAAUpG,EAAMC,EAAMC,EAAOC,IACzBF,EAAKmG,WAELnG,EAAKkC,iBAAmBlC,EAAKkC,kBAAoBiE,IAD1DnG,EAAKkC,gBAAgBnC,EAAMC,EAAMC,EAAOC,GAO1CA,EAAMqB,EAAO6E,QAAQvC,GAEjB7D,EAAKqG,UACPrG,EAAKqG,SAASxC,EAAO,CAAE9D,KAAAA,EAAM6D,MAAAA,GAtC/B,CAwCF,CACF,EACF,QDmJAlD,OAAOC,OAAO0C,EAAgBlB,SAAU,CACtCqB,MAAO,kBACPP,OAAO,EACPC,UAAW,QACXmB,QAAS,OCrJXU,EAAOoB,8IAEPpB,EAAO5C,SAAW,CAChBoD,MAAO,EACPQ,QAlGc,SAACO,GAAC,OAAKC,mBAAmBC,OAAOF,GAAGG,OAAOC,cAAcC,QAAQ,OAAQ,KAAK,EAmG5FX,qBAAsB,EACtBE,SAAU,KACVN,cAnGF,SAAwBrE,GACtB,OAAOA,EACJiB,OAAO,SAAAyB,GAAC,MAAI,CAAC,OAAQ,eAAeV,SAASU,EAAEH,KAAK,GACpD8C,IAAI,SAAA3C,GAAC,OAAIA,EAAE9C,OAAO,GAClB0B,KAAK,GACV,EAiGEsD,WAAW,EACXjE,gBAAiBiE,EACjBpF,eAAgBoF,EAAqBhE,eACrCb,eAAgB6E,EAAqBhE,SAASc,MAC9C7B,gBAAiB,IACjBK,gBAA6D,WAA5C0E,EAAqBhE,SAASe,UAC/ClC,cAAemF,EAAqBhE,SAASR,WAC7CT,eAAgBiF,EAAqBhE,SAASP,aAQhDmD,EAAc,QAAGA"}